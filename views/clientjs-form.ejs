;(function(host) {
  window.console = window.console || {};
  window.console.log = window.console.log || function(){};
  window.console.warn = window.console.warn || function(){};
  window.validate = function(){
    console.log("in validate");
    var name = document.getElementById("osrev-name").value;
    var email = document.getElementById("osrev-email").value;
    var phone = document.getElementById("osrev-tel").value;
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/; 
    var illegalChars = /^[a-zA-Z\s]+$/;
    var stripped = phone.replace(/[\(\)\.\-\ ]/g, '');
    console.log("Stripped Value",stripped);
    if(name=='' && email=='' && phone=='') {
      document.getElementById('error_name').innerHTML = "Please enter Name.";
      document.getElementById('error_email').innerHTML = "Please enter Email Address.";
      document.getElementById('error_phone').innerHTML = "Please enter Phone Number.";
      return false;
    }
    if(name=="")
    {
      document.getElementById('error_name').innerHTML = "Please enter Name.";
      return false;
    }
    else if(name.length<4)
    {
    document.getElementById('error_name').innerHTML = "Name Length should be greater than 4 Characters.";
      return false;
    }
    else if(!illegalChars.test(name))
    {
    document.getElementById('error_name').innerHTML = "Illegal Characters in Name. Only letters allowed.";
      return false;

    }
    else
    {
      document.getElementById('error_name').innerHTML = "";
    }
    if(email=="" || !re.test(email))
    {
      document.getElementById('error_email').innerHTML = "Please enter a Valid Email.";
      return false;
    }
    else
    {
      document.getElementById('error_email').innerHTML = "";
    }
    if(phone=="" || isNaN(parseInt(stripped)))
    {
      document.getElementById('error_phone').innerHTML = "Please enter a valid Phone Number.";
      return false;
    }
    else if((stripped.length != 10))
    {
      document.getElementById('error_phone').innerHTML = "Phone Number Length should be 10 numbers.";
      return false;
    }
    else
    {
      document.getElementById('error_phone').innerHTML = "";
    }
    document.getElementById("osrev-tel").value = stripped;
    return true;
  }
  window.ReviewForm = function(form_id, element_id) {
    var el = document.getElementById(element_id);

    if(!el) {
      throw "Could not find any element with ID " + element_id;
    }
    var defaultDisplay = el.style.display;
    el.style.display = 'none';

    var formURI = host + '/form/' + form_id;

    if(el.tagName !== "iframe" || el.src !==  formURI) {
      window.console.warn("WARNING: Replacing any element EXCEPT for an " +
          "iframe with the src attribute set to " + formURI + " is not "  +
          "recommended, as your form will not be visible to users with "  +
          "JavaScript disabled."
      );
    }

    formURI += "?m"; // (m)inimal: don't give us CSS, JS, etc.

    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
    console.log("We got a stateready", xhr);
      if(xhr.readyState === 4) {
        el.style.display = defaultDisplay;
        if(xhr.status !== 200) {
          throw "There was an error accessing the remote form: " +
            xhr.responseText + " (code " + xhr.status + ")";
        }
        var div = document.createElement('div');
        div.innerHTML = xhr.responseText;
        console.log("The response text", xhr.responseText.length, el, el.parentNode, div);
        el.parentNode.replaceChild(div, el);
      }
    };
    console.log("what is the uri", formURI);
    xhr.open('GET', formURI);
    xhr.send();
  }
}('<%= url %>'));

